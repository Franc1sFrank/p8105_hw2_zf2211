---
title: "p8105_hw2_zf2211"
author: "Francis"
date: "9/30/2018"
output: github_document
---

```{r problem0}
library(tidyverse)
library(tidyr)
```

##Problem1
```{r problem1}
Transit_Data = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada)
```

```{r}
select(Transit_Data, entry) %>% 
mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```
This dataset contains variables like: 
```{r}
names(Transit_Data)
```


I used __janitor::clean_names__ to clean the names of data, then __select__ several variables from the data, at last converted the entry into logical variables.

The number of rows and columns of the resulting dataset is 
```{r}
nrow(Transit_Data)
ncol(Transit_Data)
```

No, it is not yet tidy because route1 to route11 is separated. It will be better to 
sort out together.

1)There are 
```{r}
count(distinct(Transit_Data, station_name, line))
```
stations.

2)There are 
```{r}
count(distinct(filter(Transit_Data, ada == TRUE), station_name))
```
stations are ADA compliant.

3)The proportion of station entrance/exits without vending allow entrance is 
```{r}
count(distinct(Transit_Data, entrances, vending = FALSE, entry = TRUE)) /
  count(distinct(Transit_Data, entrances))
```

4)There are 
```{r}
count(distinct(filter(Transit_Data, route1 == "A")))
```
distict stations serve A train.

5)Of the stations that serve the A train, there are
```{r}
count(distinct(filter(Transit_Data, route1 == "A", ada == TRUE)))
```
distinct stations are ADA compliant.

##Problem2
```{r}
library(readxl)
library(tidyverse)
```

```{r problem2}
MrTrash_Wheel = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 1, range = "A2:N338") %>% 
  janitor::clean_names() %>% 
  filter(!is.na("weight")) %>% 
  mutate(as.integer(round(sports_balls)))
```

```{r}
prcp2016 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 5, range = "A2:B14") %>% 
  janitor::clean_names() %>%
  filter(!is.na("Total")) %>% 
  mutate(year = 2016)
```

```{r}
prcp2017 = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 4, range = "A2:B14") %>% 
  janitor::clean_names() %>%
  filter(!is.na("Total")) %>% 
  mutate(year = 2017)
```

Combine datasets
```{r}
prcp = 
  bind_rows(prcp2016, prcp2017) %>%
   mutate(month = month.name[month]) %>% 
    select(year, month, total)
```


The MrTrash_Wheel dataset contains `r nrow(MrTrash_Wheel)` rows and `r ncol(MrTrash_Wheel)` columns, and the prcp dataset contains `r nrow(prcp)` rows and `r ncol(prcp)` columns. We focus on the weight, volumn and different items; total precipitation of each month. The total precipitation in 2017 was `r sum(prcp2017$total)`, and the median number of sports balls in a dumpster in 2016 was `r median(filter(MrTrash_Wheel, year == 2016)$sports_balls)`


```{r problem3}
devtools::install_github("p8105/p8105.datasets")
library(p8105.datasets)
data(brfss_smart2010, package = "p8105.datasets")
```

```{r}
brfss = 
  brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter (topic == "Overall Health") %>% 
  select (-class, -topic, - question, -sample_size, -(confidence_limit_low:geo_location)) %>% 
  spread (key = response, value = data_value ) %>% 
  janitor::clean_names() %>% 
  mutate(Proportion = excellent + very_good)
```

